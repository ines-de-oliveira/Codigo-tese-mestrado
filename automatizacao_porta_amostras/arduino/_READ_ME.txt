Esta versão ainda não foi testada!
Eu tirei a linha que permitia voltar à posição inicial do array em caso de overflow porque acho que é inútil.
Esta versão é a versão cujo código foi colocado em pdf para pôr na tese.